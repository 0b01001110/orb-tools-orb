description: >
  Convert BATS tests' TAP output to JUnit XML, for Test Summary

parameters:
  results-dir:
    type: string
    default: test-results
    description: >
      Filepath (absolute/relative) to directory in which to output
      JUnit-formatted test results XML (if it does not exist,
      it will be created; if filepath is relative,
      directory will be created from your working directory)

  results-name:
    type: string
    default: bats
    description: >
      Name for this set of test results (controls what name displays
      in Test Summary section; corresponds to name of subdirectory
      created within <<parameters.results-dir>>)

steps:
  - run:
      name: Create test results directory structure
      command: |
        mkdir -p \
          <<parameters.results-dir>>/<<parameters.results-name>>

  - run:
      name: Convert BATS output to JUNIT XML
      command: |
        echo 'not done yet'

  - store_test_results:
      path: <<parameters.results-dir>>

  - store_artifacts:
      path: <<parameters.results-dir>>
