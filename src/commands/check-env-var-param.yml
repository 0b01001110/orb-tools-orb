description: >
  Check that env-var parameters are defined, produce an error otherwise

parameters:
  command-name:
    type: string
    default: Checking if parameters are defined...
    description: Name for CircleCI step output

  param:
    type: string
    default: ""
    description: >
      Comma-separated list of `env_var_name`-type values; all will be
      checked to ensure they are defined. Designed to be called at the
      beginning of an orb job or command, with a value like the following:
      `<<parameters.foo>>,<<parameters.bar>>,<<parameters.baz>`, etc.

  error-message:
    type: string
    default: ""
    description: >
      Optional custom message to print if parameter is undefined. A
      standard message describing the missing environment variable
      which produced the error is always printed, but this can be used
      to pass a custom string to provide more specific information.

  exit-if-undefined:
    type: boolean
    default: true
    description: >
      Should a job automatically fail if the given parameter is not defined?

steps:
  - run:
      name: <<parameters.command-name>>
      environment:
        PARAM: <<parameters.param>>
        ERR_MSG: <<parameters.error-message>>
        EXIT_IF_UNDEFINED: <<#parameters.exit-if-undefined>>1<</parameters.exit-if-undefined>>
      command: <<include(scripts/check-env-var-param.sh)>>
